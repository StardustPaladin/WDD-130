<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <title>Echoes of Hallownest — Explore</title>
    <link rel="stylesheet" href="styles/site-plan.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body class="explore">
    <header>
      <h1>Echoes of Hallownest</h1>
      <h2>Explore Hallownest</h2>
    </header>

    <nav>
      <a href="index.html">Home</a>
      <a href="explore.html">Explore</a>
      <a href="legends.html">Legends</a>
      <a href="site-plan.html">Site Plan</a>
    </nav>

    <main>
      <h2>Map</h2>
      <section class="map-section">
        <div class="map-wrap" aria-label="Map of Hallownest" role="application">
          <img class="map-img" src="images/map of hollownest.png" alt="Map of Hallownest">
          <!-- markers: adjust left/top percentage to move them -->
          <button class="map-marker" style="left:30%; top:42%;" data-title="Fog Canyon" data-desc="A glowing maze filled with jellyfish enemies and explosive hazards.">●</button>
          <button class="map-marker" style="left:70%; top:35%;" data-title="Resting Grounds" data-desc="Quiet tombs filled with spirits and ancient graves.">●</button>
          <button class="map-marker" style="left:60%; top:65%;" data-title="Royal Waterways" data-desc="Dark tunnels full of grime and creatures">●</button>

          <div id="map-popup" class="map-popup" role="dialog" aria-hidden="true">
            <button id="map-popup-close" class="close" aria-label="Close popup">✕</button>
            <h3 id="map-popup-title"></h3>
            <p id="map-popup-desc"></p>
          </div>
        </div>
      </section>

      <section class="info-section">
        <h3>How it works</h3>
        <p>Click a marker on the map to see details about the area, enemies, and notable locations. Use the popup to read short descriptions for deeper lore visit the Legends page.</p>
        <p><a href="legends.html">Open Legends</a> • <a href="index.html">Back to Home</a></p>
      </section>
    </main>

    <footer>
      <p>Echoes of Hallownest &copy; 2025 — Joey Boehner</p>
      <p><a href="site-plan.html">Site Plan</a></p>
    </footer>
    <script>
      (function(){
        const popup = document.getElementById('map-popup');
        const popupTitle = document.getElementById('map-popup-title');
        const popupDesc = document.getElementById('map-popup-desc');
        const popupClose = document.getElementById('map-popup-close');

        document.querySelectorAll('.map-marker').forEach(marker => {
          marker.addEventListener('click', (e) => {
            const t = marker.dataset.title || 'Location';
            const d = marker.dataset.desc || '';
            popupTitle.textContent = t;
            popupDesc.textContent = d;

            // position the popup near the clicked marker (inside the .map-wrap)
            const mapWrap = marker.closest('.map-wrap');
            if (mapWrap) {
              const containerRect = mapWrap.getBoundingClientRect();
              const markerRect = marker.getBoundingClientRect();
              // compute marker center relative to container
              const left = markerRect.left - containerRect.left + markerRect.width / 2;
              const top = markerRect.top - containerRect.top + markerRect.height / 2;
              popup.style.left = left + 'px';
              popup.style.top = top + 'px';
            }

            popup.style.display = 'block';
            popup.setAttribute('aria-hidden','false');
          });
        });

        popupClose.addEventListener('click', () => {
          popup.style.display = 'none';
          popup.setAttribute('aria-hidden','true');
        });

        document.addEventListener('click', (e) => {
          if (!popup.contains(e.target) && !e.target.classList.contains('map-marker')) {
            popup.style.display = 'none';
            popup.setAttribute('aria-hidden','true');
          }
        });
      })();
    </script>
  </body>
</html>